// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

// <auto-generated/>

#nullable disable

using System;
using System.Collections.Generic;
using System.Text.Json;
using System.Threading.Tasks;
using Azure.Core;
using Azure.Identity;
using NUnit.Framework;

namespace Azure.Analytics.Experimentation.Samples
{
    public partial class Samples_Metrics
    {
        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_GetMetric_GetMetricByMetricName()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response response = client.GetMetric("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", null, null);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_GetMetric_GetMetricByMetricName_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response response = await client.GetMetricAsync("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", null, null);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_GetMetric_GetMetricByMetricName_Convenience()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response<Metric> response = client.GetMetric("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard");
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_GetMetric_GetMetricByMetricName_Convenience_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response<Metric> response = await client.GetMetricAsync("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard");
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateAverage()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Average revenue per purchase [USD]",
                description = "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Average",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                        filter = "Revenue > 0",
                    },
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "avg_purchase_revenue", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateAverage_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Average revenue per purchase [USD]",
                description = "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Average",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                        filter = "Revenue > 0",
                    },
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "avg_purchase_revenue", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateEventCount()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Number of purchases (credit card)",
                description = "The number of purchase transactions made with credit card. Refund transactions are excluded from this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "EventCount",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                        filter = "Revenue > 0 and ['payment.method'] == 'credit_card'",
                    }
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateEventCount_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Number of purchases (credit card)",
                description = "The number of purchase transactions made with credit card. Refund transactions are excluded from this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "EventCount",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                        filter = "Revenue > 0 and ['payment.method'] == 'credit_card'",
                    }
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateEventRate()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Refund rate",
                description = "The percentage of transactions that are refunds. This metric is calculated as the number of refund transactions divided by the total number of transactions.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Neutral",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "EventRate",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                    },
                    ["condition"] = "Revenue < 0"
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "rate_refund", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateEventRate_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Refund rate",
                description = "The percentage of transactions that are refunds. This metric is calculated as the number of refund transactions divided by the total number of transactions.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Neutral",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "EventRate",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                    },
                    ["condition"] = "Revenue < 0"
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "rate_refund", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdatePercentile()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "95th percentile of page load time [ms]",
                description = "The 95th percentile of the page load time for all pages. Measured in milliseconds. Review page-specific metric results to identify pages that need optimization.",
                lifecycle = "Active",
                tags = new object[]
            {
"Performance",
"Important"
            },
                desiredDirection = "Decrease",
                definition = new
                {
                    kind = "Percentile",
                    value = new
                    {
                        eventName = "PageLoad",
                        eventProperty = "LoadTime_ms",
                    },
                    percentile = 95,
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "p95_page_load_time", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdatePercentile_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "95th percentile of page load time [ms]",
                description = "The 95th percentile of the page load time for all pages. Measured in milliseconds. Review page-specific metric results to identify pages that need optimization.",
                lifecycle = "Active",
                tags = new object[]
            {
"Performance",
"Important"
            },
                desiredDirection = "Decrease",
                definition = new
                {
                    kind = "Percentile",
                    value = new
                    {
                        eventName = "PageLoad",
                        eventProperty = "LoadTime_ms",
                    },
                    percentile = 95,
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "p95_page_load_time", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateSum()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Total revenue [USD]",
                description = "The total revenue in USD. Refund transactions contribute negatively to this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization",
"Important"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Sum",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                    },
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "sum_revenue", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateSum_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Total revenue [USD]",
                description = "The total revenue in USD. Refund transactions contribute negatively to this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization",
"Important"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Sum",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                    },
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "sum_revenue", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateUserCount()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Users with purchase",
                description = "The number of users who have made at least one purchase transaction. Refund transactions are excluded from this metric. As the analysis period grows, this metric begins to saturate as users making multiple purchases no longer contribute.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "UserCount",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                        filter = "Revenue > 0",
                    }
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "users_purchase", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateUserCount_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Users with purchase",
                description = "The number of users who have made at least one purchase transaction. Refund transactions are excluded from this metric. As the analysis period grows, this metric begins to saturate as users making multiple purchases no longer contribute.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new Dictionary<string, object>
                {
                    ["kind"] = "UserCount",
                    ["event"] = new
                    {
                        eventName = "Transaction",
                        filter = "Revenue > 0",
                    }
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "users_purchase", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateUserRate()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Subscription ad conversion rate",
                description = "The percentage of users who saw an advertisement for a subscription promotion and then later successfully subscribed. This metric is calculated as the number of users who successfully subscribed after seeing the advert divided by the total number of users who saw the advert. Users who saw multiple adverts or subscribed multiple times are counted only once. Users who saw the advert before the analysis period starts are excluded from this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "UserRate",
                    startEvent = new
                    {
                        eventName = "AdView",
                        filter = "Source == 'subscription_promo'",
                    },
                    endEvent = new
                    {
                        eventName = "Subscribe",
                        filter = "Status == 'Success'",
                    },
                },
            });
            Response response = client.CreateOrUpdate("00000000-0000-0000-0000-000000000000", "rate_subscription_ad", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_CreateOrUpdate_MetricsCreateOrUpdateUserRate_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Subscription ad conversion rate",
                description = "The percentage of users who saw an advertisement for a subscription promotion and then later successfully subscribed. This metric is calculated as the number of users who successfully subscribed after seeing the advert divided by the total number of users who saw the advert. Users who saw multiple adverts or subscribed multiple times are counted only once. Users who saw the advert before the analysis period starts are excluded from this metric.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "UserRate",
                    startEvent = new
                    {
                        eventName = "AdView",
                        filter = "Source == 'subscription_promo'",
                    },
                    endEvent = new
                    {
                        eventName = "Subscribe",
                        filter = "Status == 'Success'",
                    },
                },
            });
            Response response = await client.CreateOrUpdateAsync("00000000-0000-0000-0000-000000000000", "rate_subscription_ad", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("id").ToString());
            Console.WriteLine(result.GetProperty("lifecycle").ToString());
            Console.WriteLine(result.GetProperty("displayName").ToString());
            Console.WriteLine(result.GetProperty("description").ToString());
            Console.WriteLine(result.GetProperty("tags")[0].ToString());
            Console.WriteLine(result.GetProperty("desiredDirection").ToString());
            Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
            Console.WriteLine(result.GetProperty("eTag").ToString());
            Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metrics_Validate_MetricsValidate()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Average revenue per purchase [USD]",
                description = "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Average",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                        filter = "Revenue >",
                    },
                },
            });
            Response response = client.Validate("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("diagnostics")[0].GetProperty("message").ToString());
            Console.WriteLine(result.GetProperty("diagnostics")[0].GetProperty("code").ToString());
            Console.WriteLine(result.GetProperty("result").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metrics_Validate_MetricsValidate_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            using RequestContent content = RequestContent.Create(new
            {
                displayName = "Average revenue per purchase [USD]",
                description = "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                lifecycle = "Active",
                tags = new object[]
            {
"Monetization"
            },
                desiredDirection = "Increase",
                definition = new
                {
                    kind = "Average",
                    value = new
                    {
                        eventName = "Transaction",
                        eventProperty = "Revenue",
                        filter = "Revenue >",
                    },
                },
            });
            Response response = await client.ValidateAsync("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", content);

            JsonElement result = JsonDocument.Parse(response.ContentStream).RootElement;
            Console.WriteLine(result.GetProperty("diagnostics")[0].GetProperty("message").ToString());
            Console.WriteLine(result.GetProperty("diagnostics")[0].GetProperty("code").ToString());
            Console.WriteLine(result.GetProperty("result").ToString());
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metrics_Validate_MetricsValidate_Convenience()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Metric body = new Metric(
                LifecycleStage.Active,
                "Average revenue per purchase [USD]",
                "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                new string[] { "Monetization" },
                DesiredDirection.Increase,
                new AverageDefinition(new AggregatedValue("Transaction", "Revenue")
                {
                    Filter = "Revenue >",
                }));
            Response<MetricValidateResult> response = client.Validate("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", body);
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metrics_Validate_MetricsValidate_Convenience_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Metric body = new Metric(
                LifecycleStage.Active,
                "Average revenue per purchase [USD]",
                "The average revenue per purchase transaction in USD. Refund transactions are excluded from this metric. The total revenue might increase while this metric decreases if the number of purchases increases.",
                new string[] { "Monetization" },
                DesiredDirection.Increase,
                new AverageDefinition(new AggregatedValue("Transaction", "Revenue")
                {
                    Filter = "Revenue >",
                }));
            Response<MetricValidateResult> response = await client.ValidateAsync("00000000-0000-0000-0000-000000000000", "events_purchase_creditcard", body);
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_Delete_DeleteMetricByMetricNameUsingLongRunningOperation()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response response = client.Delete("00000000-0000-0000-0000-000000000000", "avg_purchase_revenue");

            Console.WriteLine(response.Status);
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_Delete_DeleteMetricByMetricNameUsingLongRunningOperation_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            Response response = await client.DeleteAsync("00000000-0000-0000-0000-000000000000", "avg_purchase_revenue");

            Console.WriteLine(response.Status);
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_GetMetrics_MetricsList()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            foreach (BinaryData item in client.GetMetrics("00000000-0000-0000-0000-000000000000", null))
            {
                JsonElement result = JsonDocument.Parse(item.ToStream()).RootElement;
                Console.WriteLine(result.GetProperty("id").ToString());
                Console.WriteLine(result.GetProperty("lifecycle").ToString());
                Console.WriteLine(result.GetProperty("displayName").ToString());
                Console.WriteLine(result.GetProperty("description").ToString());
                Console.WriteLine(result.GetProperty("tags")[0].ToString());
                Console.WriteLine(result.GetProperty("desiredDirection").ToString());
                Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
                Console.WriteLine(result.GetProperty("eTag").ToString());
                Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
            }
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_GetMetrics_MetricsList_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            await foreach (BinaryData item in client.GetMetricsAsync("00000000-0000-0000-0000-000000000000", null))
            {
                JsonElement result = JsonDocument.Parse(item.ToStream()).RootElement;
                Console.WriteLine(result.GetProperty("id").ToString());
                Console.WriteLine(result.GetProperty("lifecycle").ToString());
                Console.WriteLine(result.GetProperty("displayName").ToString());
                Console.WriteLine(result.GetProperty("description").ToString());
                Console.WriteLine(result.GetProperty("tags")[0].ToString());
                Console.WriteLine(result.GetProperty("desiredDirection").ToString());
                Console.WriteLine(result.GetProperty("definition").GetProperty("kind").ToString());
                Console.WriteLine(result.GetProperty("eTag").ToString());
                Console.WriteLine(result.GetProperty("lastModifiedAt").ToString());
            }
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public void Example_Metric_GetMetrics_MetricsList_Convenience()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            foreach (Metric item in client.GetMetrics("00000000-0000-0000-0000-000000000000"))
            {
            }
        }

        [Test]
        [Ignore("Only validating compilation of examples")]
        public async Task Example_Metric_GetMetrics_MetricsList_Convenience_Async()
        {
            Uri endpoint = new Uri("<endpoint>");
            TokenCredential credential = new DefaultAzureCredential();
            Metrics client = new OnlineExperimentationClient(endpoint, credential).GetMetricsClient(apiVersion: "2024-11-30-preview");

            await foreach (Metric item in client.GetMetricsAsync("00000000-0000-0000-0000-000000000000"))
            {
            }
        }
    }
}
